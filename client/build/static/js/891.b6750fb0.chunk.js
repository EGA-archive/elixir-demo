"use strict";(self.webpackChunkbeacon_template_ui=self.webpackChunkbeacon_template_ui||[]).push([[891],{7891:(e,t,r)=>{r.r(t),r.d(t,{default:()=>pe});var l=r(5043),n=r(3969),a=r(5895),i=r(2272),o=r(4986),s=r(405),d=r(2731),u=r(639),c=r(6172),p=r(4799),h=r(8259),f=r(7443),m=r(756),x=r(4375),y=r(8128),v=r(7174),g=r(579);const b=e=>{let{item:t}=e;const r=t.results;return(0,g.jsx)(c.A,{children:(0,g.jsx)(d.A,{colSpan:5,sx:{backgroundColor:"background.paper",borderTop:"1px solid",borderColor:"divider",p:2},children:(0,g.jsx)(n.A,{children:(0,g.jsx)(Typography,{variant:"body2",color:"textSecondary",children:(null===r||void 0===r?void 0:r.description)||"No description available"})})})},`modal-row-${t.id}`)};var j=r(3089),A=r(256),w=r(183),S=r(9441),$=r(8865),C=r(8387),P=r(1807),k=r(3491),I=r(9066),T=r(9192),B=r(1977),O=r(9905);const q=(0,y.Ay)("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[{[`& .${B.A.primary}`]:t.primary},{[`& .${B.A.secondary}`]:t.secondary},t.root,r.inset&&t.inset,r.primary&&r.secondary&&t.multiline,r.dense&&t.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${k.A.root}:where(& .${B.A.primary})`]:{display:"block"},[`.${k.A.root}:where(& .${B.A.secondary})`]:{display:"block"},variants:[{props:e=>{let{ownerState:t}=e;return t.primary&&t.secondary},style:{marginTop:6,marginBottom:6}},{props:e=>{let{ownerState:t}=e;return t.inset},style:{paddingLeft:56}}]}),R=l.forwardRef((function(e,t){const r=(0,T.b)({props:e,name:"MuiListItemText"}),{children:n,className:i,disableTypography:o=!1,inset:s=!1,primary:d,primaryTypographyProps:u,secondary:c,secondaryTypographyProps:p,slots:h={},slotProps:f={},...m}=r,{dense:x}=l.useContext(I.A);let y=null!=d?d:n,v=c;const b={...r,disableTypography:o,inset:s,primary:!!y,secondary:!!v,dense:x},j=(e=>{const{classes:t,inset:r,primary:l,secondary:n,dense:a}=e,i={root:["root",r&&"inset",a&&"dense",l&&n&&"multiline"],primary:["primary"],secondary:["secondary"]};return(0,P.A)(i,B.b,t)})(b),A={slots:h,slotProps:{primary:u,secondary:p,...f}},[w,S]=(0,O.A)("root",{className:(0,C.A)(j.root,i),elementType:q,externalForwardedProps:{...A,...m},ownerState:b,ref:t}),[$,k]=(0,O.A)("primary",{className:j.primary,elementType:a.A,externalForwardedProps:A,ownerState:b}),[R,z]=(0,O.A)("secondary",{className:j.secondary,elementType:a.A,externalForwardedProps:A,ownerState:b});return null==y||y.type===a.A||o||(y=(0,g.jsx)($,{variant:x?"body2":"body1",component:k?.variant?void 0:"span",...k,children:y})),null==v||v.type===a.A||o||(v=(0,g.jsx)(R,{variant:"body2",color:"textSecondary",...z,children:v})),(0,g.jsxs)(w,{...S,children:[y,v]})}));var z=r(2775),L=r(3699),M=r(2097),E=r(9992);const D=(0,E.A)((0,g.jsx)("path",{d:"M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0s.41-1.08 0-1.49zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"SearchRounded"),V=(0,E.A)((0,g.jsx)("path",{d:"M16.59 9H15V4c0-.55-.45-1-1-1h-4c-.55 0-1 .45-1 1v5H7.41c-.89 0-1.34 1.08-.71 1.71l4.59 4.59c.39.39 1.02.39 1.41 0l4.59-4.59c.63-.63.19-1.71-.7-1.71M5 19c0 .55.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1H6c-.55 0-1 .45-1 1"}),"DownloadRounded"),_=(0,E.A)((0,g.jsx)("path",{d:"M8.12 9.29 12 13.17l3.88-3.88c.39-.39 1.02-.39 1.41 0s.39 1.02 0 1.41l-4.59 4.59c-.39.39-1.02.39-1.41 0L6.7 10.7a.996.996 0 0 1 0-1.41c.39-.38 1.03-.39 1.42 0"}),"KeyboardArrowDownRounded");var F,H,N=r(6235);function U(){return U=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var l in r)({}).hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},U.apply(null,arguments)}function W(e,t){let{title:r,titleId:n,...a}=e;return l.createElement("svg",U({width:24,height:18,viewBox:"0 0 24 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},a),r?l.createElement("title",{id:n},r):null,F||(F=l.createElement("g",{clipPath:"url(#clip0_4284_16283)"},l.createElement("path",{d:"M17 16.5L17 1.5M11.5 16.5L11.5 1.5M6 16.5L6 1.5",stroke:"#023452",strokeWidth:2.5,strokeLinecap:"round",strokeLinejoin:"round"}))),H||(H=l.createElement("defs",null,l.createElement("clipPath",{id:"clip0_4284_16283"},l.createElement("rect",{width:18,height:24,fill:"white",transform:"translate(7.86805e-07 18) rotate(-90)"})))))}const Z=l.forwardRef(W);r.p;function G(e){var t,r;let{visibleColumns:l,setVisibleColumns:a,searchTerm:i,setSearchTerm:o,sortedHeaders:s,count:d,handleExport:u}=e;const{responseMeta:c}=(0,N.B)(),p=v.ui.colors,h=null===c||void 0===c||null===(t=c.receivedRequestSummary)||void 0===t||null===(r=t.pagination)||void 0===r?void 0:r.limit;return(0,g.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",my:2,flexDirection:{xs:"column",md:"row"},alignItems:{xs:"flex-start",md:"center"},gap:{xs:2,md:0}},children:[(0,g.jsxs)(n.A,{sx:{color:p.darkPrimary,fontSize:"14px",display:"flex",flexDirection:"column",alignItems:"flex-start",mt:"auto",gap:"2px"},children:[(0,g.jsxs)(n.A,{children:[(0,g.jsx)("b",{children:"Total Results:"})," ",d?new Intl.NumberFormat(navigator.language).format(d):"\u2014"]}),d>h&&(0,g.jsxs)(n.A,{children:["Details returned for the first ",h," records"]})]}),(0,g.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:{xs:1,sm:1,md:2,lg:3}},children:[(0,g.jsx)(A.A,{size:"small",children:(0,g.jsx)(w.A,{multiple:!0,displayEmpty:!0,value:l,onChange:e=>a(e.target.value),renderValue:()=>(0,g.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,g.jsx)(Z,{sx:{color:p.darkPrimary}}),(0,g.jsx)("span",{style:{color:p.darkPrimary,opacity:1,fontSize:"12px"},children:"Select column"})]}),sx:{borderRadius:"24px",height:"40px","& .MuiOutlinedInput-notchedOutline":{borderColor:p.darkPrimary},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:p.primary},"& .MuiSelect-select":{display:"flex",alignItems:"center",gap:"8px",py:.5,width:{xs:"120px",sm:"150px",md:"150px",lg:"200px"},height:"40px"}},IconComponent:_,children:s.map((e=>(0,g.jsxs)(S.A,{value:e.id,children:[(0,g.jsx)($.A,{size:"small",checked:l.indexOf(e.id)>-1,sx:{color:p.darkPrimary,"&.Mui-checked":{color:p.primary}}}),(0,g.jsx)(R,{primary:e.name,primaryTypographyProps:{sx:{fontSize:"13px",color:p.darkPrimary}}})]},e.id)))})}),(0,g.jsx)(z.A,{size:"small",placeholder:"Search keywords",value:i,onChange:e=>o(e.target.value),sx:{width:{xs:"160px",sm:"170px",md:"170px",lg:"237px"},"& .MuiOutlinedInput-root":{borderRadius:"24px",height:"40px","& fieldset":{borderColor:p.darkPrimary},"&:hover fieldset":{borderColor:p.primary},"& input::placeholder":{color:p.darkPrimary,opacity:1,fontSize:"12px"}}},InputProps:{startAdornment:(0,g.jsx)(L.A,{position:"start",size:"small",children:(0,g.jsx)(D,{sx:{color:p.darkPrimary}})})}}),(0,g.jsx)(M.A,{variant:"outlined",size:"large",sx:{px:2,borderColor:p.darkPrimary,borderRadius:"24px","& .MuiButton-startIcon":{marginLeft:0,marginRight:0}},onClick:u,startIcon:(0,g.jsx)(V,{sx:{color:p.darkPrimary}})})]})]})}function J(e){if(!e||"object"!==typeof e)return"-";const t=Object.entries(e).map((e=>{let[t,r]=e;const l=(e=>{if(!Array.isArray(e))return null;const t=e.map((e=>null==e?null:"object"===typeof e?e.label||e.text||e.id||null:String(e))).filter(Boolean);return t.length?t.join(", "):null})(r);return l?`${(e=>e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/_/g," ").replace(/^./,(e=>e.toUpperCase())))(t)}: ${l}`:null})).filter(Boolean);return t.length?t.join("\n"):"-"}function K(e,t){if("measures"===t)return function(e){if(!Array.isArray(e)||0===e.length)return"-";const t=e.map((e=>{var t,r,l,n;const a=null===e||void 0===e||null===(t=e.assayCode)||void 0===t?void 0:t.label,i=null===e||void 0===e||null===(r=e.measurementValue)||void 0===r?void 0:r.value,o=null===e||void 0===e||null===(l=e.measurementValue)||void 0===l||null===(n=l.unit)||void 0===n?void 0:n.label,s=null===e||void 0===e?void 0:e.date;return a&&null!=i?`${a}: ${"number"===typeof i?i.toFixed(2):i}`+(o?` ${o}`:"")+(s?` (${s})`:""):null})).filter(Boolean);return t.length?t.join("\n"):"-"}(e);if("info"===t)return function(e){if(!e||"object"!==typeof e)return"-";const t=e=>e.toLowerCase().includes("ontologyterm"),r=e=>e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/_/g," ").replace(/^./,(e=>e.toUpperCase())),l=e=>null==e?null:"object"===typeof e?e.label?e.label:e.text?e.text:Object.entries(e).filter((e=>{let[r]=e;return!t(r)})).map((e=>{let[,t]=e;return l(t)})).filter(Boolean).join(", "):String(e),n=e=>Array.isArray(e)?e.map((e=>n(e))).filter(Boolean).join("\n"):"object"===typeof e?Object.entries(e).filter((e=>{let[r]=e;return!t(r)})).map((e=>{let[t,n]=e;const a=l(n);return a?`${r(t)}: ${a}`:null})).filter(Boolean).join("\n"):String(e),a=Object.entries(e).map((e=>{let[t,l]=e;const a=n(l);return a?a.includes("\n")?`${r(t)}:\n${a}`:`${r(t)}: ${a}`:null})).filter(Boolean);return a.length?a.join("\n"):"-"}(e);if("interventionsOrProcedures"===t)return function(e){if(!Array.isArray(e)||0===e.length)return"-";const t=e.map((e=>{var t;return null===e||void 0===e||null===(t=e.procedureCode)||void 0===t?void 0:t.label})).filter(Boolean);return 0===t.length?"-":t.join("\n")}(e);if("molecularAttributes"===t)return J(e);if("variation"===t)return function(e){if(!e||"object"!==typeof e)return"-";const t=[];if(e.location){var r,l;const{type:n,sequence_id:a,interval:i}=e.location;n&&t.push(`Location type: ${function(e){return e.replace(/([a-z])([A-Z])/g,"$1 $2")}(n)}`),a&&t.push(`Sequence Id: ${a}`),null!=(null===i||void 0===i||null===(r=i.start)||void 0===r?void 0:r.value)&&null!=(null===i||void 0===i||null===(l=i.end)||void 0===l?void 0:l.value)&&(t.push("Sequence interval:"),t.push(`  Start: ${i.start.value}`),t.push(`  End: ${i.end.value}`))}return e.alternateBases&&t.push(`Alternate bases: ${e.alternateBases}`),e.referenceBases&&t.push(`Reference bases: ${e.referenceBases}`),e.variantType&&t.push(`Variant type: ${e.variantType}`),t.length?t.join("\n"):"-"}(e);if("caseLevelData"===t)return function(e){if(!Array.isArray(e)||0===e.length)return"-";const t=e.map((e=>{var t;const r=null===e||void 0===e?void 0:e.biosampleId,l=null===e||void 0===e||null===(t=e.zygosity)||void 0===t?void 0:t.label;return r&&l?`${r}: ${l}`:null})).filter(Boolean);return t.length?t.join("\n"):"-"}(e);if(null==e)return"-";if(Array.isArray(e))return e.map((e=>K(e))).join(", ");if("object"===typeof e){if(e.label)return e.label;if(e.id)return e.id;const t=Object.values(e).map((e=>K(e))).filter(Boolean);return t.length?t.join(", "):"-"}return"string"===typeof e||"number"===typeof e?e:"-"}function Q(e){const t=e.replace(/([A-Z])/g," $1");return t.charAt(0).toUpperCase()+t.slice(1)}function Y(e){let{value:t}=e;if(!Array.isArray(t)||0===t.length)return"-";const r=t.map((e=>{var t;return null===e||void 0===e||null===(t=e.procedureCode)||void 0===t?void 0:t.label})).filter(Boolean);return 0===r.length?"-":1===r.length?(0,g.jsx)("span",{children:r[0]}):(0,g.jsx)(n.A,{component:"ul",sx:{pl:2,m:0},children:r.map(((e,t)=>(0,g.jsx)("li",{children:e},t)))})}function X(e){let{value:t}=e;if(!Array.isArray(t)||0===t.length)return"-";const r=e=>{var t,r,l,n;const a=null===e||void 0===e||null===(t=e.assayCode)||void 0===t?void 0:t.label,i=null===e||void 0===e||null===(r=e.measurementValue)||void 0===r?void 0:r.value,o=null===e||void 0===e||null===(l=e.measurementValue)||void 0===l||null===(n=l.unit)||void 0===n?void 0:n.label,s=null===e||void 0===e?void 0:e.date;if(!a||null==i)return null;const d="number"===typeof i?i.toFixed(2):i;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("b",{children:a}),": ",d,o?` ${o}`:"",s?` (${s})`:""]})};return 1===t.length?(0,g.jsx)(n.A,{children:r(t[0])}):(0,g.jsx)(n.A,{component:"ul",sx:{m:0,listStyleType:"disc",listStylePosition:"inside"},children:t.map(((e,t)=>{const l=r(e);return l?(0,g.jsx)("li",{children:l},t):null}))})}function ee(e){let{value:t}=e;if(!t||"object"!==typeof t)return"-";const r=e=>e.toLowerCase().includes("ontologyTerm"),l=e=>null==e?null:"object"===typeof e?e.label?e.label:e.text?e.text:Object.entries(e).filter((e=>{let[t]=e;return!r(t)})).map((e=>{let[t,r]=e;return l(r)})).filter(Boolean).join(", "):String(e),a=e=>(0,g.jsx)(n.A,{sx:{display:"flex",flexDirection:"column",gap:.25},children:e.map(((e,t)=>(0,g.jsxs)(n.A,{sx:{display:"flex",alignItems:"flex-start"},children:[(0,g.jsx)(n.A,{sx:{width:12,lineHeight:"14px"},children:"\u2022"}),(0,g.jsx)(n.A,{sx:{flex:1},children:e})]},t)))}),i=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Array.isArray(e)){const t=e.map((e=>i(e,!1))).filter(Boolean);return a(t)}if("object"===typeof e){const n=Object.entries(e).filter((e=>{let[t]=e;return!r(t)})).map((e=>{let[t,r]=e;const n=l(r);return n?`${te(t)}: ${n}`:null})).filter(Boolean);return 1!==n.length||t?a(n):n[0]}return String(e)};return(0,g.jsx)(n.A,{sx:{display:"flex",flexDirection:"column",gap:.5},children:Object.entries(t).map((e=>{let[t,r]=e;const l=i(r);return l?(0,g.jsxs)(n.A,{children:[(0,g.jsxs)("b",{children:[te(t),":"]})," ",(0,g.jsx)(n.A,{component:"span",children:l})]},t):null}))})}function te(e){return e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/_/g," ").replace(/^./,(e=>e.toUpperCase()))}function re(e){let{value:t}=e;if(!t||"object"!==typeof t)return"-";const r=Object.entries(t).map((e=>{let[t,r]=e;const l=(e=>Array.isArray(e)?e.map((e=>null==e?null:"object"===typeof e?e.label||e.text||e.id||null:String(e))).filter(Boolean).join(", "):null)(r);return l?`${function(e){return e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/_/g," ").replace(/^./,(e=>e.toUpperCase()))}(t)}: ${l}`:null})).filter(Boolean);return 0===r.length?"-":(0,g.jsx)(n.A,{sx:{display:"flex",flexDirection:"column",gap:.25},children:r.map(((e,t)=>(0,g.jsxs)(n.A,{sx:{display:"flex",alignItems:"flex-start"},children:[(0,g.jsx)(n.A,{sx:{width:12},children:"\u2022"}),(0,g.jsxs)(n.A,{sx:{flex:1},children:[(0,g.jsxs)("b",{children:[e.split(":")[0],":"]}),e.slice(e.indexOf(":")+1)]})]},t)))})}function le(e){let{value:t}=e;if(!t||"object"!==typeof t)return"-";const r=[];if(t.location){var l,a;const{type:e,sequence_id:i,interval:o}=t.location;e&&r.push((0,g.jsx)(ne,{label:"Location type",value:ae(e)},"location-type")),i&&r.push((0,g.jsx)(ne,{label:"Sequence Id",value:i},"sequence-id")),null!=(null===o||void 0===o||null===(l=o.start)||void 0===l?void 0:l.value)&&null!=(null===o||void 0===o||null===(a=o.end)||void 0===a?void 0:a.value)&&r.push((0,g.jsxs)(n.A,{children:[(0,g.jsx)("b",{children:"Sequence interval:"}),(0,g.jsxs)(n.A,{sx:{pl:2},children:["Start: ",o.start.value,(0,g.jsx)("br",{}),"End: ",o.end.value]})]},"interval"))}return t.alternateBases&&r.push((0,g.jsx)(ne,{label:"Alternate bases",value:t.alternateBases},"alt")),t.referenceBases&&r.push((0,g.jsx)(ne,{label:"Reference bases",value:t.referenceBases},"ref")),t.variantType&&r.push((0,g.jsx)(ne,{label:"Variant type",value:t.variantType},"type")),(0,g.jsx)(n.A,{sx:{display:"flex",flexDirection:"column",gap:.25},children:r.map(((e,t)=>(0,g.jsxs)(n.A,{sx:{display:"flex",alignItems:"flex-start"},children:[(0,g.jsx)(n.A,{sx:{width:12},children:"\u2022"}),(0,g.jsx)(n.A,{sx:{flex:1},children:e})]},t)))})}function ne(e){let{label:t,value:r}=e;return(0,g.jsxs)(n.A,{children:[(0,g.jsxs)("b",{children:[t,":"]})," ",r]})}function ae(e){return e.replace(/([a-z])([A-Z])/g,"$1 $2")}function ie(e){let{value:t}=e;if(!Array.isArray(t)||0===t.length)return"-";const r=t.map((e=>{var t;const r=null===e||void 0===e?void 0:e.biosampleId,l=null===e||void 0===e||null===(t=e.zygosity)||void 0===t?void 0:t.label;return r&&l?`${r}: ${l}`:null})).filter(Boolean);if(0===r.length)return"-";const{entries:l,truncated:a}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;if(null==e)return{entries:[],truncated:!1};const r=Array.isArray(e)?e.map((e=>K(e))).filter(Boolean):[K(e)].filter(Boolean);return r.length<=t?{entries:r,truncated:!1}:{entries:r.slice(0,t),truncated:!0,total:r.length}}(r,20);return 1===l.length?(0,g.jsx)(n.A,{sx:{whiteSpace:"nowrap"},children:l[0]}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(n.A,{sx:{display:"flex",flexWrap:"wrap",gap:"6px 16px",fontSize:"11px",width:"100%"},children:l.map(((e,t)=>(0,g.jsxs)(n.A,{sx:{whiteSpace:"nowrap",flex:"0 0 calc(33.333% - 16px)",lineHeight:1.3},children:[e,a&&t===l.length-1?" \u2026":""]},t)))}),a&&(0,g.jsx)(n.A,{sx:{mt:.5,fontSize:"11px"},children:(0,g.jsx)("b",{children:"List truncated for readability. Please download the dataset for the complete set of case-level records at this position."})})]})}const oe=e=>{let{dataTable:t,entryTypeId:r,selectedPathSegment:a,beaconId:i,datasetId:o,displayedCount:s,headers:A=[],visibleColumns:w,setVisibleColumns:S,page:$,rowsPerPage:C,setSearchTerm:P,searchTerm:k,setSearchCount:I}=e;const[T,B]=(0,l.useState)(null),[O,q]=(0,l.useState)([]),R=(0,l.useRef)(!1),z=$*C,L=z+C;(0,l.useEffect)((()=>{q(t)}),[t]);const M=(0,l.useMemo)((()=>(0,y.Ay)(d.A)((e=>{let{theme:t}=e;return{[`&.${u.A.head}`]:{backgroundColor:v.ui.colors.darkPrimary,color:t.palette.common.white},[`&.${u.A.body}`]:{fontSize:11},border:`1px solid ${v.ui.colors.darkPrimary}`}}))),[]),E=(0,l.useMemo)((()=>(0,y.Ay)(c.A)((e=>{let{theme:t}=e;return{"&:nth-of-type(odd)":{backgroundColor:t.palette.action.hover},"&:last-child td":{border:`1px solid ${v.ui.colors.darkPrimary}`},"&:last-child th":{border:"1px solid white"}}}))),[]),D=(0,l.useMemo)((()=>({backgroundColor:v.ui.colors.darkPrimary,fontWeight:700,color:"white"})),[]),V=(0,l.useMemo)((()=>(A.length>0?A:Array.from(new Set(t.flatMap((e=>e&&"object"===typeof e?Object.keys(e):[]))))).map((e=>({id:e,name:"identifiers"===e?"Genomic variation":Q(e)}))).filter((e=>"variantInternalId"!==e.id))),[t,A]),_=(0,l.useMemo)((()=>{var e,t;const r=(null===(e=V.find((e=>"id"===e.id)))||void 0===e?void 0:e.id)||(null===(t=V.find((e=>"identifiers"===e.id)))||void 0===t?void 0:t.id);return r?[...V.filter((e=>e.id===r)),...V.filter((e=>e.id!==r))]:V}),[V]);(0,l.useEffect)((()=>{!R.current&&_.length>0&&0===w.length&&(S(_.map((e=>e.id))),R.current=!0)}),[_,w.length,S]),(0,l.useEffect)((()=>{const e=t.filter((e=>{if(!k)return!0;return _.map((t=>K(e[t.id]))).join(" ").toLowerCase().includes(k.toLowerCase())}));q(e),I&&I(e.length)}),[k,t,_]);const F=(0,l.useMemo)((()=>O.slice(z,L)),[O,z,L]),H=(0,l.useCallback)((()=>{(async e=>{let{dataTable:t,sortedHeaders:r,visibleColumns:l,summarizeValue:n,searchTerm:a="",entryTypeId:i,selectedPathSegment:o,queryBuilder:s,datasetId:d}=e;try{let e=[];if(a.trim())e=t.filter((e=>r.map((t=>n(e[t.id],t.id))).join(" ").toLowerCase().includes(a.toLowerCase())));else{var u,c;const t=s([],i);t.query.pagination={skip:0,limit:100};const r=`${v.apiUrl}/${o}`,l=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!l.ok)return console.error("Fetch failed with status:",l.status),void alert("Failed to fetch data for export.");const n=await l.json(),a=(null!==(u=null===n||void 0===n||null===(c=n.response)||void 0===c?void 0:c.resultSets)&&void 0!==u?u:[]).find((e=>e.id===d||e.dataset===d));if(!a)return void alert(`No dataset found for ID: ${d}`);e=a.results||[]}if(!e.length)return void alert("No data available to export.");const p=r.filter((e=>l.includes(e.id))),h=p.map((e=>e.id)),f=[p.map((e=>e.name)).join(","),...e.map((e=>h.map((t=>{const r=n(void 0!==e[t]&&null!==e[t]?e[t]:"",t);return"string"===typeof r?`"${r.replace(/"/g,'""')}"`:r})).join(",")))].join("\n"),m=new Blob([f],{type:"text/csv;charset=utf-8;"}),x=URL.createObjectURL(m),y=`beacon-${o||"results"}-${(new Date).toISOString().split("T")[0]}.csv`,g=document.createElement("a");g.href=x,g.setAttribute("download",y),document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(x)}catch(p){console.error("CSV export failed:",p),alert("CSV export failed. Check the console for details.")}})({dataTable:t,sortedHeaders:_,visibleColumns:w,summarizeValue:K,searchTerm:k,entryTypeId:r,selectedPathSegment:a,queryBuilder:j.y,datasetId:o})}),[t,_,w,k,r,a,o]),N={interventionsOrProcedures:Y,measures:X,info:ee,molecularAttributes:re,variation:le,caseLevelData:ie},U=(0,l.useCallback)(((e,t)=>{const r=e[t];return r?"phenotypicFeatures"!==t&&"exposures"!==t||!Array.isArray(r)?K(r):r.map((e=>{if("object"!==typeof e||null===e)return e;return Object.entries(e).map((e=>{let[t,r]=e;if(!r)return null;if("object"===typeof r&&!Array.isArray(r)){var l,n,a,i,o,s;if(r.iso8601duration)return`Age at exposure: ${r.iso8601duration}`;if(r.label)return`${t}: ${r.label}`;if(r.id)return`${t}: ${r.id}`;const e=(null===(l=r.evidenceCode)||void 0===l?void 0:l.label)||(null===(n=r.featureType)||void 0===n?void 0:n.label)||(null===(a=r.exposureCode)||void 0===a?void 0:a.label)||(null===(i=r.onset)||void 0===i?void 0:i.label)||(null===(o=r.unit)||void 0===o?void 0:o.label)||(null===(s=r.severity)||void 0===s?void 0:s.label);return e?`${t}: ${e}`:null}if(Array.isArray(r)){const e=r.map((e=>e.label||e.id||null)).filter(Boolean);return e.length?`${t}: ${e.join(", ")}`:null}return"string"===typeof r||"number"===typeof r?`${t}: ${r}`:null})).filter(Boolean).join(", ")})).filter(Boolean).join(" | "):"-"}),[]);return(0,g.jsxs)(n.A,{sx:{maxHeight:"70vh",display:"flex",flexDirection:"column"},children:["networkBeacon"===v.beaconType&&(0,g.jsxs)(n.A,{sx:{color:v.ui.colors.darkPrimary,fontSize:"14px",display:"flex",alignItems:"flex-end",mt:"auto",gap:"6px"},children:["Beacon: ",(0,g.jsx)("b",{children:i||"\u2014"})]}),(0,g.jsxs)(n.A,{sx:{color:v.ui.colors.darkPrimary,fontSize:"14px",display:"flex",alignItems:"flex-end",mt:"auto",gap:"6px"},children:["Dataset: ",(0,g.jsx)("b",{children:o||"\u2014"})]}),(0,g.jsx)(G,{visibleColumns:w,setVisibleColumns:S,searchTerm:k,setSearchTerm:P,handleExport:H,sortedHeaders:_,count:s}),(0,g.jsx)(p.A,{sx:{width:"100%",flexGrow:1,boxShadow:"none",borderRadius:0,display:"flex",flexDirection:"column"},children:(0,g.jsx)(h.A,{sx:{maxHeight:"60vh",overflow:"visible"},children:(0,g.jsxs)(f.A,{stickyHeader:!0,"aria-label":"Results table",children:[(0,g.jsx)(m.A,{children:(0,g.jsx)(E,{children:_.filter((e=>w.includes(e.id))).map((e=>(0,g.jsx)(d.A,{sx:D,children:(0,g.jsx)(n.A,{sx:{display:"flex",alignItems:"center",gap:"6px"},children:e.name})},e.id)))})}),(0,g.jsx)(x.A,{children:F.map(((e,t)=>{const r=null!==T&&T.id===e.id,n=function(e){try{if("string"!==typeof e)return null;const t=e.replace(/"|"/g,'"');return JSON.parse(t)}catch(t){return null}}(e.info),a=`${e.id||`row_${t}`}${null!==n&&void 0!==n&&n.sampleID?`_${n.sampleID}`:""}`;return(0,g.jsxs)(l.Fragment,{children:[(0,g.jsx)(E,{hover:!0,sx:{"&.MuiTableRow-root":{transition:"background-color 0.2s ease"},"& td":{borderBottom:"1px solid rgba(224,224,224,1)",py:1.5},fontWeight:"bold"},children:_.filter((e=>w.includes(e.id))).map((t=>(0,g.jsx)(M,{sx:{fontSize:"11px",whiteSpace:"wrap",overflowWrap:"anywhere",verticalAlign:"top"},"data-cy":"identifiers"===t.id?"variant-identifiers-cell":void 0,style:{width:t.width||"auto",maxWidth:"variantInternalId"===t.id?"300px":"250px"},children:(()=>{const r=N[t.id];return r?(0,g.jsx)(r,{value:e[t.id]}):U(e,t.id)})()},`${a}-${t.id}`)))}),r&&(0,g.jsx)(b,{item:T},`expanded-${a}`)]},a)}))})]})})})]})};var se=r(7421),de=r(2579),ue=r(3760),ce=r(3395);r(2745);const pe=e=>{var t,r;let{open:d,subRow:u,onClose:c,beaconId:p,datasetId:h,headers:f}=e;const{selectedPathSegment:m,selectedFilter:x,responseMeta:y}=(0,N.B)(),[b,j]=(0,l.useState)(0),[A,w]=(0,l.useState)(0),[S,$]=(0,l.useState)(0),[C,P]=(0,l.useState)(!1),[k,I]=(0,l.useState)(5),[T,B]=(0,l.useState)([]),[O,q]=(0,l.useState)(""),[R,z]=(0,l.useState)(""),[L,M]=(0,l.useState)([]),[E,D]=(0,l.useState)(null),V=ce.xQ[m];null===y||void 0===y||null===(t=y.receivedRequestSummary)||void 0===t||null===(r=t.pagination)||void 0===r||r.limit;(0,l.useEffect)((()=>{f&&f.length>0&&0===L.length&&M(f)}),[f,L.length]);const _=(e,t)=>{j(t)},F=e=>{const t=parseInt(e.target.value,10);I(t),j(0)},H=()=>{q(""),j(0),w(0),$(0),B([]),c()};return(0,l.useEffect)((()=>{var e;if(!d)return;let t=!0;if(0===b&&(null===u||void 0===u||null===(e=u.dataTable)||void 0===e?void 0:e.length)>0)return B(u.dataTable),$(u.dataTable.length),w(Math.ceil(u.dataTable.length/k)),void P(!1);return(async()=>{var e;if(!((null===u||void 0===u||null===(e=u.dataTable)||void 0===e?void 0:e.length)>0))try{var r,l;P(!0);const e=`${v.apiUrl}/${m}`;z(e);const n=(()=>{const e={meta:{apiVersion:"2.0"},query:{filters:[],requestParameters:{},includeResultsetResponses:"HIT",pagination:{skip:0,limit:100},testMode:!1,requestedGranularity:"record"}};return x.length>0&&x.forEach((t=>{t.queryParams?e.query.requestParameters={...e.query.requestParameters,...t.queryParams}:t.operator?e.query.filters.push({id:t.id,operator:t.operator,value:t.value}):e.query.filters.push({id:t.id,...t.scope?{scope:t.scope}:{}})})),e.query.requestParameters&&0!==Object.keys(e.query.requestParameters).length||delete e.query.requestParameters,0===e.query.filters.length&&delete e.query.filters,e})(),a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),i=await a.json();if(!t)return;const o=null===(r=i.response)||void 0===r?void 0:r.resultSets;if(null===o||void 0===o||!o.length)return;let s=o.find((e=>(u.beaconId||u.id)===(e.beaconId||e.id)));if(s||(s=o[0]),null===(l=s)||void 0===l||!l.results)return;const d=Math.ceil(s.resultsCount/k);$(s.resultsCount),w(d),B(s.results)}catch(n){console.error("Failed to fetch modal table:",n)}finally{P(!1)}})(),()=>{t=!1}}),[d,u,b,k]),(0,l.useEffect)((()=>{j(0)}),[O]),(0,g.jsx)(o.A,{open:d,onClose:H,children:(0,g.jsx)(s.A,{in:d,children:(0,g.jsxs)(n.A,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90%",maxWidth:"1200px",height:"80vh",bgcolor:"background.paper",borderRadius:2,boxShadow:24,display:"flex",flexDirection:"column",overflow:"hidden",p:4},children:[(0,g.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[(0,g.jsx)(a.A,{id:"modal-modal-title",sx:{fontWeight:"bold",fontSize:"17px",color:v.ui.colors.darkPrimary},children:"Results detailed table"}),(0,g.jsx)(de.A,{onClick:H,size:"small",sx:{color:v.ui.colors.darkPrimary},children:(0,g.jsx)(se.A,{fontSize:"small"})})]}),(0,g.jsxs)(n.A,{sx:{flex:1,overflowY:"auto",minHeight:0,pr:1},children:[C&&(0,g.jsx)(ue.A,{message:"Loading data..."}),!C&&T.length>0&&(0,g.jsx)(oe,{dataTable:T,totalItems:S,page:b,rowsPerPage:k,totalPages:A,handleChangePage:_,handleChangeRowsPerPage:F,primary:v.ui.colors.primary,entryTypeId:V,selectedPathSegment:m,beaconId:p,datasetId:h,displayedCount:(null===u||void 0===u?void 0:u.displayedCount)||0,actualLoadedCount:(null===u||void 0===u?void 0:u.actualLoadedCount)||0,headers:f,visibleColumns:L,setVisibleColumns:M,searchTerm:O,setSearchTerm:q,setSearchCount:D})]}),(0,g.jsx)(n.A,{sx:{display:"flex",justifyContent:"flex-end",mt:1},children:(0,g.jsx)(i.A,{component:"div",count:O?null!==E&&void 0!==E?E:0:S,page:b,onPageChange:_,rowsPerPage:k,onRowsPerPageChange:F,rowsPerPageOptions:[5,10,20],showFirstButton:!0,showLastButton:!0})})]})})})}}}]);
//# sourceMappingURL=891.b6750fb0.chunk.js.map